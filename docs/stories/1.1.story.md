# Story 1.1: Project Scaffolding & CI Setup

## Status

In Progress

## Story

**As a** developer,
**I want** a properly configured Tauri + Svelte project with CI/CD,
**so that** I have a solid foundation for building EZ Flow with automated quality checks.

## Acceptance Criteria

1. Tauri v2 project initialized with Svelte frontend (TypeScript)
2. Project builds successfully on Windows, macOS, and Linux
3. GitHub Actions workflow runs on every push: lint, type-check, `cargo test`, `bun test`
4. README includes development setup instructions
5. Basic logging infrastructure in place (Rust `tracing` crate)
6. `.gitignore` properly configured for Tauri/Svelte/Rust artifacts
7. Dependabot or Renovate configured for dependency updates

## Tasks / Subtasks

- [ ] **Task 1: Initialize Tauri v2 + Svelte 5 Project** (AC: 1)
  - [ ] Run `bun create tauri-app` with Svelte template
  - [ ] Configure for TypeScript (strict mode)
  - [ ] Update `src-tauri/Cargo.toml` with project metadata (name: `ez-flow`, version: `0.1.0`)
  - [ ] Verify Tauri v2.x and Svelte 5.x versions in dependencies
  - [ ] Configure Vite 5.x with `@sveltejs/vite-plugin-svelte`

- [ ] **Task 2: Configure Project Structure** (AC: 1)
  - [ ] Create directory structure per architecture:
    ```
    src-tauri/src/
    ├── commands/mod.rs
    ├── services/mod.rs
    ├── state/mod.rs
    ├── models/mod.rs
    └── error.rs
    ```
  - [ ] Create frontend structure:
    ```
    src/lib/
    ├── components/
    ├── stores/
    ├── services/
    └── types/index.ts
    ```
  - [ ] Set up `tauri.conf.json` with app identifier `com.ezflow.app`

- [ ] **Task 3: Configure Tailwind CSS** (AC: 1)
  - [ ] Install Tailwind CSS, PostCSS, Autoprefixer
  - [ ] Create `tailwind.config.js` with EZCorp design tokens (from front-end-spec)
  - [ ] Configure `postcss.config.js`
  - [ ] Add Tailwind directives to `src/app.css`

- [ ] **Task 4: Set Up Rust Logging with Tracing** (AC: 5)
  - [ ] Add `tracing` and `tracing-subscriber` to `Cargo.toml`
  - [ ] Initialize tracing in `main.rs` with console output
  - [ ] Add `tracing-appender` for file logging (app data directory)
  - [ ] Create logging configuration in `src-tauri/src/lib.rs`
  - [ ] Add example log statements at info/debug/error levels

- [ ] **Task 5: Configure .gitignore** (AC: 6)
  - [ ] Add Rust artifacts (`target/`, `Cargo.lock` for library, `*.rlib`, `*.rmeta`)
  - [ ] Add Node artifacts (`node_modules/`, `bun.lockb`)
  - [ ] Add Tauri artifacts (`src-tauri/target/`, `src-tauri/WixTools/`, `src-tauri/gen/`)
  - [ ] Add IDE settings (`.vscode/`, `.idea/`)
  - [ ] Add OS files (`.DS_Store`, `Thumbs.db`)
  - [ ] Add build outputs (`dist/`, `build/`)
  - [ ] Keep `bun.lockb` tracked (unlike `Cargo.lock` for libraries)

- [ ] **Task 6: Create GitHub Actions CI Workflow** (AC: 3)
  - [ ] Create `.github/workflows/ci.yml`
  - [ ] Configure matrix for Windows, macOS (arm64+x64), Linux
  - [ ] Install system dependencies:
    - Linux: `libgtk-3-dev libwebkit2gtk-4.1-dev libappindicator3-dev librsvg2-dev patchelf libasound2-dev`
  - [ ] Add steps: checkout, setup Bun, setup Rust, install deps, lint, type-check, cargo test, bun test
  - [ ] Configure caching for Cargo and Bun

- [ ] **Task 7: Add Linting and Formatting** (AC: 3)
  - [ ] Configure `rustfmt.toml` with project style
  - [ ] Add `clippy` checks in CI with `-D warnings`
  - [ ] Configure ESLint for TypeScript/Svelte
  - [ ] Add Prettier for frontend formatting
  - [ ] Add `bun run lint` and `bun run format` scripts to `package.json`

- [ ] **Task 8: Configure Dependabot** (AC: 7)
  - [ ] Create `.github/dependabot.yml`
  - [ ] Configure for Cargo ecosystem (weekly)
  - [ ] Configure for npm/bun ecosystem (weekly)
  - [ ] Configure for GitHub Actions (monthly)
  - [ ] Set appropriate reviewers and labels

- [ ] **Task 9: Verify Cross-Platform Build** (AC: 2)
  - [ ] Run `bun tauri build` locally
  - [ ] Verify CI passes on all three platforms
  - [ ] Fix any platform-specific build issues

- [ ] **Task 10: Write README with Setup Instructions** (AC: 4)
  - [ ] Add project description and features overview
  - [ ] Document prerequisites (Rust 1.75+, Bun, platform-specific deps)
  - [ ] Add development setup steps (clone, install, run)
  - [ ] Add build instructions for each platform
  - [ ] Add CI badge

- [ ] **Task 11: Add Unit Test Infrastructure** (AC: 3)
  - [ ] Ensure `cargo test` runs (even with 0 tests initially)
  - [ ] Ensure `bun test` runs with placeholder test
  - [ ] Create `src/lib/stores/transcription.test.ts` skeleton
  - [ ] Create `src-tauri/src/lib.rs` with basic test module

## Dev Notes

### Tech Stack [Source: architecture.md#2]

| Component | Technology | Version |
|-----------|------------|---------|
| App Framework | Tauri | v2.x |
| Frontend | Svelte | 5.x |
| Backend | Rust | 1.75+ |
| Build Tool | Vite | 5.x |
| Package Manager | Bun | latest |
| CSS | Tailwind CSS | 3.x |

### Rust Dependencies for This Story [Source: architecture.md#2.2]

```toml
[dependencies]
tauri = { version = "2", features = ["tray-icon"] }
serde = { version = "1", features = ["derive"] }
serde_json = "1"
tokio = { version = "1", features = ["full"] }
tracing = "0.1"
tracing-subscriber = { version = "0.3", features = ["env-filter"] }
thiserror = "1"
```

### Frontend Dependencies [Source: architecture.md#2.5]

```json
{
  "@tauri-apps/api": "^2",
  "svelte": "^5",
  "@sveltejs/vite-plugin-svelte": "^4",
  "tailwindcss": "^3",
  "typescript": "^5"
}
```

### Project Structure [Source: architecture.md#3]

```
ez-flow/
├── src-tauri/
│   ├── Cargo.toml
│   ├── tauri.conf.json
│   ├── capabilities/default.json
│   ├── icons/
│   └── src/
│       ├── main.rs
│       ├── lib.rs
│       ├── commands/mod.rs
│       ├── services/mod.rs
│       ├── state/mod.rs
│       ├── models/mod.rs
│       └── error.rs
├── src/
│   ├── app.html
│   ├── app.css
│   ├── main.ts
│   ├── App.svelte
│   └── lib/
│       ├── components/
│       ├── stores/
│       ├── services/
│       └── types/index.ts
├── .github/workflows/ci.yml
├── package.json
├── vite.config.ts
├── svelte.config.js
├── tailwind.config.js
├── tsconfig.json
└── README.md
```

### CI/CD Configuration [Source: architecture.md#10.1]

GitHub Actions matrix:
- `windows-latest`
- `macos-latest` (universal builds for arm64+x64)
- `ubuntu-22.04`

Linux dependencies:
```bash
sudo apt-get install -y libgtk-3-dev libwebkit2gtk-4.1-dev \
  libappindicator3-dev librsvg2-dev patchelf libasound2-dev
```

### Logging Setup [Source: architecture.md#2.2]

Initialize tracing in Rust:
```rust
use tracing_subscriber::{fmt, prelude::*, EnvFilter};

fn init_logging() {
    tracing_subscriber::registry()
        .with(fmt::layer())
        .with(EnvFilter::from_default_env()
            .add_directive("ez_flow=debug".parse().unwrap()))
        .init();
}
```

### Testing

**Test File Locations** [Source: architecture.md#3, #11]:
- Rust unit tests: Inline in source files with `#[cfg(test)]` modules
- Rust integration tests: `src-tauri/tests/`
- Frontend unit tests: `src/lib/**/*.test.ts`
- E2E tests: `tests/e2e/` (not required for this story)

**Testing Frameworks**:
- Rust: Built-in `cargo test`
- Frontend: `bun test` (Bun's built-in test runner)

**Test Commands**:
```bash
cargo test                    # Rust tests
bun test                      # Frontend tests
bun run test:e2e             # E2E tests (Epic 1 later)
```

**For This Story**:
- Create placeholder test in `src/lib/stores/transcription.test.ts`
- Add `#[cfg(test)]` module in `src-tauri/src/lib.rs` with placeholder
- Verify both `cargo test` and `bun test` pass in CI

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2024-12-28 | 0.1 | Initial story draft | Bob (SM) |

---

## Dev Agent Record

### Agent Model Used

*To be filled by dev agent*

### Debug Log References

*To be filled by dev agent*

### Completion Notes List

*To be filled by dev agent*

### File List

*To be filled by dev agent*

---

## QA Results

*To be filled by QA agent*
